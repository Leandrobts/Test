<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS4 Browser Research - Test Suite v3</title>
</head>
<body>

<h1>PS4 Browser Research — FW 13.04 | v3.0</h1>
<p>User-Agent: <span id="ua"></span></p>
<p>Todos os testes exibem <b>⚠ ALERTA</b> quando detectam anomalia concreta.</p>
<hr>

<h2>Batch 1 — Memory / OOM / Crash (Tests 01–10)</h2>
<table border="1" cellpadding="5">
<tr><th>#</th><th>Tecnica</th><th>Vetor</th><th>Link</th></tr>
<tr><td>01</td><td>TypedArray Memory Bomb</td><td>Float64Array OOM</td><td><a href="test01.html">ABRIR</a></td></tr>
<tr><td>02</td><td>ArrayBuffer Detach Race</td><td>postMessage transfer</td><td><a href="test02.html">ABRIR</a></td></tr>
<tr><td>03</td><td>FontFaceSet UAF Pattern</td><td>FontFaceSet heap</td><td><a href="test03.html">ABRIR</a></td></tr>
<tr><td>04</td><td>Canvas 2D Extreme</td><td>ImageData backing store</td><td><a href="test04.html">ABRIR</a></td></tr>
<tr><td>05</td><td>Web Worker OOM Flood</td><td>Worker + transfer</td><td><a href="test05.html">ABRIR</a></td></tr>
<tr><td>06</td><td>DOM Recursive Bomb</td><td>cloneNode / innerHTML</td><td><a href="test06.html">ABRIR</a></td></tr>
<tr><td>07</td><td>ImageData Heap Spray</td><td>history.state uninit</td><td><a href="test07.html">ABRIR</a></td></tr>
<tr><td>08</td><td>JSC Type Confusion</td><td>JIT array getter</td><td><a href="test08.html">ABRIR</a></td></tr>
<tr><td>09</td><td>Regex + String Bomb</td><td>String heap OOM</td><td><a href="test09.html">ABRIR</a></td></tr>
<tr><td>10</td><td>rAF + Detached Node Race</td><td>render UAF</td><td><a href="test10.html">ABRIR</a></td></tr>
</table>

<br>
<h2>Batch 2 — Exploit Primitives (Tests 11–20) — HackerOne friendly</h2>
<table border="1" cellpadding="5">
<tr><th>#</th><th>Tecnica</th><th>Primitivo</th><th>Link</th></tr>
<tr><td>11</td><td>Symbol.species Type Confusion</td><td>addrof via double</td><td><a href="test11.html">ABRIR</a></td></tr>
<tr><td>12</td><td>Proxy Trap UAF</td><td>GC dentro de trap</td><td><a href="test12.html">ABRIR</a></td></tr>
<tr><td>13</td><td>Iterator Protocol Abuse</td><td>type mismatch em spread</td><td><a href="test13.html">ABRIR</a></td></tr>
<tr><td>14</td><td>Arguments Aliasing JIT</td><td>addrof via args[0]</td><td><a href="test14.html">ABRIR</a></td></tr>
<tr><td>15</td><td>setPrototypeOf During Enum</td><td>OOB read butterfly</td><td><a href="test15.html">ABRIR</a></td></tr>
<tr><td>16</td><td>Canvas toDataURL Info Leak</td><td>pixel / alpha leak</td><td><a href="test16.html">ABRIR</a></td></tr>
<tr><td>17</td><td>WeakRef Zombie</td><td>objeto ressuscitado UAF</td><td><a href="test17.html">ABRIR</a></td></tr>
<tr><td>18</td><td>eval + Function JIT Deopt</td><td>deopt race / scope</td><td><a href="test18.html">ABRIR</a></td></tr>
<tr><td>19</td><td>localStorage Boundary</td><td>storage crash / leak</td><td><a href="test19.html">ABRIR</a></td></tr>
<tr><td>20</td><td>String Method Side-Effects</td><td>type confusion replace/split</td><td><a href="test20.html">ABRIR</a></td></tr>
</table>

<br>
<h2>Batch 3 — Crash Primitives com Alertas (Tests 21–30) — Sem DoS</h2>
<table border="1" cellpadding="5">
<tr><th>#</th><th>Tecnica</th><th>Por que crasha</th><th>Link</th></tr>
<tr><td>21</td><td>Array.sort Re-entrant Comparator</td><td>Butterfly UAF durante realloc no sort</td><td><a href="test21.html">ABRIR</a></td></tr>
<tr><td>22</td><td>Generator Suspenso + GC</td><td>Frame do generator coletado enquanto suspenso</td><td><a href="test22.html">ABRIR</a></td></tr>
<tr><td>23</td><td>DataView Aliasing + Detach</td><td>DataView sobre buffer detachado / offset OOB</td><td><a href="test23.html">ABRIR</a></td></tr>
<tr><td>24</td><td>Async/Await Microtask UAF</td><td>Objeto coletado antes do microtask retomar</td><td><a href="test24.html">ABRIR</a></td></tr>
<tr><td>25</td><td>Array.length Getter Re-entrant</td><td>splice/concat leem length com side-effect</td><td><a href="test25.html">ABRIR</a></td></tr>
<tr><td>26</td><td>Getter em Indice de Array (JIT)</td><td>JIT usa fast path, getter causa type change</td><td><a href="test26.html">ABRIR</a></td></tr>
<tr><td>27</td><td>Object.freeze + Reflect Bypass</td><td>Escrita em butterfly frozen via Reflect/receiver</td><td><a href="test27.html">ABRIR</a></td></tr>
<tr><td>28</td><td>RegExp.lastIndex Getter Anomalo</td><td>Loop JIT com lastIndex decrescente (loop infinito / OOB)</td><td><a href="test28.html">ABRIR</a></td></tr>
<tr><td>29</td><td>TypedArray.set() Overlap + Detach</td><td>memmove em buffer detachado / sobreposicao corrupta</td><td><a href="test29.html">ABRIR</a></td></tr>
<tr><td>30</td><td>Error.stack Leak + Structured Clone</td><td>Enderecos JIT via stack / clone ciclico crash</td><td><a href="test30.html">ABRIR</a></td></tr>
</table>

<hr>
<h2>Guia de leitura dos resultados</h2>
<p><b>⚠ ALERTA no log:</b> anomalia concreta detectada — documente e minimize o caso</p>
<p><b>Browser fecha:</b> crash confirmado — anote o teste e o botao exato</p>
<p><b>EXCECAO inesperada:</b> caminho de erro nao tratado — pode ser exploravel</p>
<p><b>Valor 0xDEADC0DE / 0xCAFEBABE como float:</b> primitivo addrof ativo</p>
<p><b>Non-zero em buffer zerado:</b> uninit memory read (info disclosure)</p>
<p><b>Loop atingiu limite:</b> possivel loop infinito por estado invalido</p>
<p><b>[OK] em todo log:</b> motor resistiu — tente o proximo botao do mesmo teste</p>

<script>
document.getElementById('ua').textContent = navigator.userAgent;
</script>
</body>
</html>

<!-- INJETADO VIA APPEND - mover para dentro do body na proxima revisao -->
<hr>
<h2>Batch 4 — Follow-up dos Achados Críticos (Tests 31–33)</h2>
<table border="1" cellpadding="5">
<tr><th>#</th><th>Baseado em</th><th>Objetivo</th><th>Sub-testes</th><th>Link</th></tr>
<tr>
  <td>31</td>
  <td>TEST 30: postMessage(ciclico) sem excecao</td>
  <td>Receber ciclo no onmessage, operar nele, ciclo+transfer double-free, mapear limite</td>
  <td>31-A: Receber | 31-B: Operar | 31-C: Transfer | 31-D: Limite</td>
  <td><a href="test31.html">ABRIR</a></td>
</tr>
<tr>
  <td>32</td>
  <td>TEST 20: Symbol.replace retornou objeto com length=99999</td>
  <td>Usar length falso para OOB read via substring/charCodeAt, primitivo addrof</td>
  <td>32-A: Confirmar | 32-B: JIT confused | 32-C: OOB substring | 32-D: addrof</td>
  <td><a href="test32.html">ABRIR</a></td>
</tr>
<tr>
  <td>33</td>
  <td>TEST 26-C: slice usou length antigo, Array.from usou novo</td>
  <td>Quantificar stale, verificar o que foi copiado, spray do butterfly, OOB via copyWithin/fill</td>
  <td>33-A: Stale quant | 33-B: O que copiou | 33-C: Butterfly spray | 33-D: OOB ops</td>
  <td><a href="test33.html">ABRIR</a></td>
</tr>
</table>
<p><b>Ordem recomendada:</b> Execute cada sub-teste em sequencia (A→B→C→D). Os sub-testes posteriores dependem do resultado dos anteriores.</p>

<hr>
<h2>Batch 5 — Exploit Primitivos (Tests 36–38) — Baseados em Achados Reais do PS4</h2>
<table border="1" cellpadding="5">
<tr><th>#</th><th>Baseado em</th><th>Primitivo Alvo</th><th>Sub-testes</th><th>Link</th></tr>
<tr>
  <td>36</td>
  <td>TEST 32-B: strLen JIT retornou 99999</td>
  <td>Usar 99999 como operando: new Array, substring, Float64Array, charCode→index</td>
  <td>A:Array(strLen) | B:substring | C:TypedArray | D:charCode offset</td>
  <td><a href="test36.html">ABRIR</a></td>
</tr>
<tr>
  <td>37</td>
  <td>TEST 33-D: lastIndexOf idx=20 além do length antigo</td>
  <td>Traversal OOB controlada via lastIndexOf, read-what-where via índice retornado</td>
  <td>A:Mapear profundidade | B:Dados controlados | C:Índice como primitivo | D:indexOf vs lastIndexOf</td>
  <td><a href="test37.html">ABRIR</a></td>
</tr>
<tr>
  <td>38</td>
  <td>TEST 33-B: slice() copiou MIX pre/pos-mod</td>
  <td>Injetar objeto em posição pós-mod → slice copia referência → addrof via bits de ponteiro</td>
  <td>A:Confirmar MIX | B:Injetar objeto | C:addrof via slice | D:map() com objeto injetado</td>
  <td><a href="test38.html">ABRIR</a></td>
</tr>
</table>
